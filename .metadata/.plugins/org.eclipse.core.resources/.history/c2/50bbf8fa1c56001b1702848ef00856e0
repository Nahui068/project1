<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ include file="/WEB-INF/views/include/header.jsp" %>

<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>장비예약</title>
	
	<!-- 제이쿼리를 사용하기 위한 라이브러리 -->
	<script src="//code.jquery.com/jquery-3.5.1.min.js"></script>
	
	<!-- fullcalendar 라이브러리 -->
	<link href='resources/packages/core/main.css' rel='stylesheet' />
	<link href='resources/packages/daygrid/main.css' rel='stylesheet' />
	<link href='resources/packages/timegrid/main.css' rel='stylesheet' />
	<link href='resources/packages/list/main.css' rel='stylesheet' />
	<script src='resources/packages/core/main.js'></script>
	<script src='resources/packages/interaction/main.js'></script>
	<script src='resources/packages/daygrid/main.js'></script>
	<script src='resources/packages/timegrid/main.js'></script>
	<script src='resources/packages/list/main.js'></script>
	<script src='resources/packages/moment/main.js'></script>
	
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.css">
	<script src="//cdnjs.cloudflare.com/ajax/libs/timepicker/1.3.5/jquery.timepicker.min.js"></script>
	
	<link href="resources/css/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link href="resources/css/style-css.css" rel="stylesheet" type="text/css">
	
	<script>
	// 날짜 포맷 yyyy-mm-dd HH:mm
	  function formatDate(date) { 
	  	var d = new Date(date), month = '' + (d.getMonth() + 1), day = '' + d.getDate(), year = d.getFullYear(), hour = d.getHours().toString(), minute = d.getMinutes().toString(); 
	  	if (month.length < 2) month = '0' + month; if (day.length < 2) day = '0' + day; 
	  	if(hour.length < 2) hour = '0' + hour; if(minute.length < 2) minute = minute + '0';
	  	var date = [year,month,day].join('-'); // 날짜
	  	var time = [hour,minute].join(':'); // 시간
	  		return date+" "+time;
	  	
	  }

	// 날짜 포맷 yyy-mm-dd
	  function formatDate2(date) { 
		  	var d = new Date(date), month = '' + (d.getMonth() + 1), day = '' + d.getDate(), year = d.getFullYear(); 
		  	if (month.length < 2) month = '0' + month; if (day.length < 2) day = '0' + day; 
		  	return [year,month,day].join('-'); // 날짜
		    	
	}

	// 시간 포맷 HH:mm
	  function formatClock(date) { 
	  	var d = new Date(date), hour = d.getHours().toString(), minute = d.getMinutes().toString(); 
	 
	  	if(hour.length < 2) hour = '0' + hour; if(minute.length < 2) minute = minute + '0';
	  	
	  	return [hour,minute].join(':'); // 시간
	  		
	  	
	  }
	  	
	document.addEventListener('DOMContentLoaded', function() {
		
	  var dataset = [
		<c:forEach var="rlist" items="${rlist}" varStatus="status">
			{"groupId":'<c:out value="${rlist.num}"/>'
			,"id":'<c:out value="${rlist.id}" />'
			,"title":'<c:out value="${rlist.title}" />'    
			,"start":'<c:out value="${rlist.res_date}"/>'+'T'+'<c:out value="${rlist.start_time}" />'
			,"end":'<c:out value="${rlist.res_date}"/>'+'T'+'<c:out value="${rlist.end_time}" />'
			,"backgroundColor":'<c:out value="${rlist.color}" />'
			},
				
		</c:forEach>
	  ];
	  	
	 var modal = document.getElementById('myModal'); // 모달창 - 예약
	 var modal2 = document.getElementById('res_modal'); // 모달창 - 예약 상세내용
	 var close = document.getElementsByClassName("close")[0]; // 닫기창 - 예약
	 var close2 = document.getElementsByClassName("close")[1]; // 닫기창 - 예약 상세내용
	 var close_button = document.getElementsByClassName("btn btn-secondary")[0]; // close버튼 - 예약
	 var close_button2 = document.getElementsByClassName("btn btn-secondary")[1]; // close버튼 - 예약 상세내용
	  	
	 var calendarEl = document.getElementById('calendar');
		
	 var calendar = new FullCalendar.Calendar(calendarEl, {
			  plugins: ['interaction','interactionPlugin','dayGrid','timeGrid' ],
			  header: {
			        left: 'prev,next today',
			        center: 'title',
			        right: 'dayGridMonth,timeGridWeek,timeGridDay'
			      },
			  defaultView: 'timeGridWeek',
			  locale : "ko",
			  selectable: true,
			  navLinks:true
		
			
		});
	 calendar.render();
	});	
	</script>
	<script>
		function eqChange(e){
			var camera = ['소니 6500','소니 캠코더1','소니 캠코더2','고프로 히어로 9','고프로 히어로 7',];
			var tripod = ['삼각대 4번','삼각대 5번','삼각대 6번','삼각대(모노포드)7번'];
			var mike = ['마이크1', '마이크2', '마이크3', '마이크4', '마이크5', '마이크6', '마이크7', '로드마이크1', '로드마이크2'];
			var target = document.getElementsByName('eq2')[0];
			
			if(e.value == "카메라") var d = camera;
			else if(e.value == "삼각대") var d = tripod;
			else if(e.value == "마이크") var d = mike;
			
			target.options.length = 0;
	
			for (x in d) {
				var opt = document.createElement("option");
				opt.value = d[x];
				opt.innerHTML = d[x];
				if(target)
					target.appendChild(opt);
			}	
		}
		

	</script>
	
	<style>
		#calendar{
		
			position:absolute;
			left:20%;
			top:70%;
			width:60%;
			height:80%;
		}

	</style>
</head>
<body>
<h1 style="position:absolute; top:40%; left:45%;">장비 예약신청</h1>

	
<form name="eqShow" method ="post" action="/project1/eq_show">
	<span style="position:absolute; top:50%; left:41%;">
		<select class="form-control" id="exampleSelect1" name="eq1" onchange="eqChange(this)">
			<option>예약구분</option>
			<option value="카메라">카메라</option>
			<option value="삼각대">삼각대</option>
			<option value="마이크">마이크</option>
		</select>
	</span>
	
	<span style="position:absolute; top:50%; left:51%;">	
		<select class="form-control" id="exampleSelect1" name="eq2">
			<option>장소</option>	
		</select>
	</span>
	
	<span style="position:absolute; top:50%; left:60%;">	
		<input type="submit" id="show_btn" name="show" class="btn btn-info" value="조회">
	</span>
</form>

<span style="position:absolute; top:58%; left:40%;">
	<c:if test="${!empty eq2}">
		<h1>${eq1} ${eq2}</h1>
	</c:if>
</span>

<div id='calendar'></div>

<!-- 예약 모달창 -->
<div id="myModal" class="modal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">예약하기</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">  
      <form name="reservationAdd" method="post">
        <table>
        	<tr>
        		<td style="text-align:center">아이디</td><td>${sessionScope.id}</td>
        		<input type="hidden" id="id" name="id" value="${sessionScope.id}">
        	</tr>
        	<tr>
				<td style="text-align:center">장소</td>
				<td>
				<select class="form-control" name ="eq1" id="exampleSelect1" onchange="roomChange_modal(this)">
					<option value=""> 예약구분</option>
					<option value="카메라" <c:if test="${eq1 eq '카메라'}"> selected </c:if>>카메라</option>
					<option value="삼각대"<c:if test="${eq1 eq '삼각대'}"> selected </c:if>>삼각대</option>
					<option value="마이크"<c:if test="${eq1 eq '마이크'}"> selected </c:if>>마이크</option>
				</select>
				</td>
				<td>
				<select class="form-control" name = "eq2" id="exampleSelect1">
					<option>장소</option>
					<c:if test="${eq1 eq '카메라' && !empty eq2}">
						<option value="소니 6500" <c:if test="${eq2 eq '소니 6500'}">selected</c:if>>소니 6500</option>
						<option value="소니 캠코더 1" <c:if test="${eq2 eq '소니 캠코더 1'}">selected</c:if>>소니 캠코더 1</option>
						<option value="소니 캠코더 2" <c:if test="${eq2 eq '소니 캠코더 2'}">selected</c:if>>소니 캠코더 2</option>
					</c:if>
					<c:if test="${eq1 eq '삼각대' && !empty eq2}">
						<option value="삼각대 4번" <c:if test="${eq2 eq '삼각대 4번'}">selected</c:if>>삼각대 4번</option>
						<option value="삼각대 5번" <c:if test="${eq2 eq '삼각대 5번'}">selected</c:if>>삼각대 5번</option>
						<option value="삼각대 6번" <c:if test="${eq2 eq '삼각대 6번'}">selected</c:if>>삼각대 6번</option>	
						<option value="삼각대(모노포드) 7번" <c:if test="${eq2 eq '삼각대(모노포드) 7번'}">selected</c:if>>삼각대(모노포드) 7번</option>	
							
					</c:if>
					<c:if test="${eq1 eq '마이크' && !empty eq2}">
						<option value="마이크1" <c:if test="${eq2 eq '마이크1'}">selected</c:if>>마이크1</option>
						<option value="마이크2" <c:if test="${eq2 eq '마이크2'}">selected</c:if>>마이크2</option>
						<option value="마이크3" <c:if test="${eq2 eq '마이크2'}">selected</c:if>>마이크2</option>	
						<option value="마이크4" <c:if test="${eq2 eq '마이크2'}">selected</c:if>>마이크2</option>	
						<option value="마이크5" <c:if test="${eq2 eq '마이크2'}">selected</c:if>>마이크2</option>	
						<option value="마이크6" <c:if test="${eq2 eq '마이크2'}">selected</c:if>>마이크2</option>	
						<option value="마이크7" <c:if test="${eq2 eq '마이크2'}">selected</c:if>>마이크2</option>	
						<option value="로드 마이크1" <c:if test="${eq2 eq '마이크2'}">selected</c:if>>마이크2</option>	
						<option value="로드 마이크2" <c:if test="${eq2 eq '마이크2'}">selected</c:if>>마이크2</option>		
					</c:if>					 
				</select>
				</td>
			</tr>
			<tr>
				<td style="text-align:center">일정명</td><td><input type="text" name="title"></td>
			</tr>
			<tr>
				<td style="text-align:center">날짜</td><td><input type="date" name="res_date" id="res_date"></td>
			</tr>        
			<tr>
				<td style="text-align:center">예약시간</td><td><input type="text" class="timepicker" name="start_time" id="start_time"></td><td><input type="text" class="timepicker" name="end_time" id="end_time"></td>
			</tr>
			<tr>
				<td style="text-align:center">색상</td>
				<td>
					<input type="color" name="color" id="color">
					<!-- <select class="custom-select" name="color" id="color">
						<select class="sc_color" name="sc_color" id="sc_color">
						<option value="">색상
						<option value="#FFEB5A" style="color:#FFEB5A;"> 노랑색</option>
						<option value="#C45FDD" style="color:#C45FDD;"> 보라색</option>
						<option value="#5AD18F" style="color:#5AD18F;"> 초록색</option>
						<option value="#5CEEE6" style="color:#5CEEE6;"> 민트색</option>
					</select>
		 -->
				</td>
			</tr>
        </table>
       </form>
      </div>      
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" id="res_submit" name="res_submit">저장</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>     
    </div>
  </div>
</div>
</body>
</html>